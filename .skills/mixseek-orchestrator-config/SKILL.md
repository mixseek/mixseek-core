---
name: mixseek-orchestrator-config
description: MixSeekのオーケストレーター設定ファイル（orchestrator.toml）を生成します。「オーケストレーターを設定」「チーム競合設定」「複数チームで競わせる」「マルチチーム実行設定」といった依頼で使用してください。複数チームを並列実行して最良の結果を選択する設定を定義します。
---

# MixSeek オーケストレーター設定生成

## 概要

MixSeek-Coreのオーケストレーター設定ファイル（orchestrator.toml）を生成します。複数のチームを並列実行し、評価者による判定を経て最良の回答を選択するTUMIX（TUrnament-style MIXture of experts）フレームワークの設定を定義します。

## 前提条件

- ワークスペースが初期化されていること（`mixseek-workspace-init`参照）
- 1つ以上のチーム設定ファイルが存在すること（`mixseek-team-config`参照）
- 評価設定が存在すること（`mixseek-evaluator-config`参照、オプション）

## 使用方法

### Step 1: 要件のヒアリング

ユーザーに以下を確認してください:

1. **競合させるチーム**: どのチーム設定を使用するか
2. **ラウンド設定**: 何ラウンド実行するか（デフォルト: 2-5ラウンド）
3. **タイムアウト設定**: チームごとの制限時間

### Step 2: 既存チーム設定の確認

ワークスペース内のチーム設定を確認:

```bash
ls $MIXSEEK_WORKSPACE/configs/agents/team-*.toml
```

### Step 3: 設定ファイルの生成

以下のテンプレートを基に設定ファイルを生成:

```toml
[orchestrator]
timeout_per_team_seconds = 600
max_rounds = 5
min_rounds = 2

[[orchestrator.teams]]
config = "configs/agents/team-a.toml"

[[orchestrator.teams]]
config = "configs/agents/team-b.toml"
```

### Step 4: ファイルの保存

生成した設定を以下のパスに保存:

```bash
$MIXSEEK_WORKSPACE/configs/orchestrator.toml
# または
$MIXSEEK_WORKSPACE/configs/orchestrator-<name>.toml
```

### Step 5: 設定ファイルの検証（必須）

**生成後は必ず検証を実行してください。**

```bash
uv run python .skills/mixseek-config-validate/scripts/validate-config.py \
    $MIXSEEK_WORKSPACE/configs/orchestrator.toml --type orchestrator
```

検証が成功したら、ユーザーに結果を報告します。失敗した場合は、エラー内容を確認して設定を修正してください。

## TUMIX（Tournament-style Mixture of Experts）とは

MixSeek-Coreのコア機能で、以下のフローで動作します:

1. **Submission Phase**: 各チームが並列でタスクを実行し、回答（Submission）を生成
2. **Evaluation Phase**: 評価者が各Submissionをスコアリング
3. **Judgment Phase**: 判定者が最終的な勝者を決定
4. **Tournament**: 上記を複数ラウンド繰り返し、最良の結果を選出

## 設定項目

### ラウンド設定

| 項目 | 説明 | デフォルト | 範囲 |
|------|------|----------|------|
| `max_rounds` | 最大ラウンド数 | 5 | 1-10 |
| `min_rounds` | 最小ラウンド数 | 2 | 1以上 |

**注意**: `min_rounds <= max_rounds` である必要があります。

### タイムアウト設定

| 項目 | 説明 | デフォルト | 範囲 |
|------|------|----------|------|
| `timeout_per_team_seconds` | チームごとのタイムアウト | 300 | 10-3600 |
| `submission_timeout_seconds` | Submission生成のタイムアウト | 300 | - |
| `judgment_timeout_seconds` | Judgment処理のタイムアウト | 60 | - |

## 例

### 2チーム競合設定

```
User: 2つのチームで競わせる設定を作って

Agent: オーケストレーター設定を提案します。

       既存のチーム設定を確認しました:
       - configs/agents/team-web-research.toml
       - configs/agents/team-analysis.toml

       設定:
       - 最大ラウンド数: 5
       - 最小ラウンド数: 2
       - チームタイムアウト: 600秒

       この構成でよろしいですか？

User: はい

Agent: 設定ファイルを生成しました:
       orchestrator.toml

       実行コマンド:
       mixseek exec --config orchestrator.toml
```

### 生成される設定ファイル例

```toml
# MixSeek Orchestrator Configuration
# Generated by mixseek-orchestrator-config skill

[orchestrator]
# ラウンド設定
max_rounds = 5
min_rounds = 2

# タイムアウト設定
timeout_per_team_seconds = 600
submission_timeout_seconds = 300
judgment_timeout_seconds = 60

# 競合チーム設定
[[orchestrator.teams]]
config = "configs/agents/team-web-research.toml"

[[orchestrator.teams]]
config = "configs/agents/team-analysis.toml"
```

### 3チーム以上の競合設定

```toml
[orchestrator]
max_rounds = 3
min_rounds = 2
timeout_per_team_seconds = 900

[[orchestrator.teams]]
config = "configs/agents/team-creative.toml"

[[orchestrator.teams]]
config = "configs/agents/team-analytical.toml"

[[orchestrator.teams]]
config = "configs/agents/team-practical.toml"
```

## 実行方法

### CLIコマンド

```bash
# 基本実行
mixseek exec --config orchestrator.toml

# 詳細ログ付き
mixseek exec --config orchestrator.toml --log-level debug

# Logfire観測付き
mixseek exec --config orchestrator.toml --logfire
```

### UIからの実行

```bash
# UI起動
mixseek ui

# 「実行」ページでorchestrator.tomlを選択して実行
```

## トラブルシューティング

### チーム設定ファイルが見つからない

```
Error: Team config not found: configs/agents/team-xxx.toml
```

**解決方法**:
1. ファイルパスが正しいか確認
2. `$MIXSEEK_WORKSPACE`からの相対パスで指定
3. `mixseek-team-config`スキルでチーム設定を作成

### ラウンド設定エラー

```
Error: min_rounds must be <= max_rounds
```

**解決方法**:
- `min_rounds`を`max_rounds`以下に設定

### タイムアウトエラー

```
Error: Team execution timed out
```

**解決方法**:
1. `timeout_per_team_seconds`を増加
2. チームの`timeout_seconds`設定を確認
3. Member Agent数を削減

## 評価・判定設定との連携

オーケストレーターは以下の設定ファイルと連携します:

- **evaluator.toml**: Submissionのスコアリング設定
- **judgment.toml**: 最終判定の設定

これらは`mixseek-evaluator-config`スキルで生成できます。

## 参照

- TOMLスキーマ詳細: `references/TOML-SCHEMA.md`
- チーム設定: `.skills/mixseek-team-config/`
- 評価設定: `.skills/mixseek-evaluator-config/`
